const fs = require('fs-extra');
const axios = require('axios');
const path = require('path');
const { getPrefix } = global.utils;
const { commands, aliases } = global.GoatBot;

module.exports = {
    config: {
        name: 'help',
        version: '1.0',
        author: 'Vincenzo || kshitiz',
        countDown: 5,
        role: 0,
        shortDescription: {
            en: 'List all available commands'
        },
        longDescription: {
            en: 'View a comprehensive list of all available commands'
        },
        category: 'info',
        guide: {
            en: '{pn} / help'
        },
        priority: 1
    },

    onStart: async function ({ message, args, event, threadsData, role }) {
        const { threadID } = event;
        const threadData = await threadsData.get(threadID);
        const prefix = getPrefix(threadID);

        if (args.length === 0) {
            await this.customHelpMessage(message);
            return;
        }

        if (args[0] === '-s') {
            const category = args[1]?.toUpperCase();
            if (category) {
                await this.listCommandsByCategory(category, message);
            } else {
                await message.reply(`Please specify a category after '-s'. Example: ${prefix}helpx -s A`);
            }
            return;
        }

        if (args[0] === '-2') {
            await this.listAllCommands(message);
            return;
        }

        const commandName = args[0].toLowerCase();
        const commandInfo = await this.getCommandInfo(commandName);

        if (commandInfo) {
            const response = `
â”â”â”  â–  â”â”â”
Â» Description: ${commandInfo.description}
Â» Other names: ${commandInfo.aliases}
Â» Other names in your group: ${commandInfo.groupAliases}
Â» Version: ${commandInfo.version}
Â» Role: ${commandInfo.roleText}
Â» Time per command: ${commandInfo.countDown}s
Â» Author: ${commandInfo.author}
â”â”â”  â–  â”â”â”
Â» Usage guide:
${commandInfo.usage}
â”â”â”  â–  â”â”â”
Â» Notes:
â€¢ The content inside <XXXXX> can be changed
â€¢ The content inside [a|b|c] is a or b or c
            `;
            await message.reply(response);
        } else {
            await message.reply(`The command "${commandName}" does not exist.`);
        }
    },

    customHelpMessage: async function (message) {
        const totalCommands = commands.size;
        const customHelpMessage = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•—
 ğ—¡ğ—œğ—¦ğ—›ğ—œğ— ğ—œğ—¬ğ—” ğ—–ğ—µğ—®ğ˜ğ—¯ğ—¼ğ˜
 â•šâ•â•â•â•â•â•â•â•â•â•â•â•

â•­â”€â”€ã€  ğ—¢ğ—ªğ—¡ğ—˜ğ—¥  ã€
âœ§adminonly âœ§approved âœ§backupdata âœ§bin âœ§bio âœ§cmd âœ§code âœ§delete cmd âœ§devonly âœ§edit8 âœ§editx âœ§event âœ§file âœ§getfbstate âœ§hubble âœ§ignoreonlyad âœ§ignoreonlyadbox âœ§jsontomongodb âœ§jsontosqlite âœ§loadconfig âœ§notice âœ§notification âœ§owner âœ§setavt âœ§setlang âœ§setrankup âœ§thread âœ§up âœ§update âœ§upt âœ§upt2 âœ§user âœ§vip âœ§w âœ§whitelist
âœ§out âœ§ping âœ§resetprefix âœ§setalias âœ§shell
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—”ğ——ğ— ğ—œğ—¡  ã€
âœ§block âœ§leave âœ§main âœ§usage âœ§notify
âœ§goatmart âœ§clean âœ§eval âœ§join âœ§pending
âœ§delete âœ§stats âœ§theme âœ§uptime âœ§uptime2
âœ§whitelistthread âœ§addfile âœ§admin list  âœ§autoseen âœ§example âœ§restart âœ§run
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—œğ— ğ—”ğ—šğ—˜  ã€
âœ§affect âœ§arrest âœ§avatar âœ§batslap âœ§blink âœ§chad âœ§coupledp âœ§ephoto âœ§giphy âœ§link âœ§pair âœ§pdf âœ§pin âœ§prodia âœ§profile âœ§sdxl âœ§sorthelp âœ§spy âœ§template âœ§trigger âœ§ws
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—§ğ—¢ğ—¢ğ—Ÿ'ğ—¦  ã€
âœ§countryinfo âœ§fakechat âœ§fakechat2 âœ§cover
âœ§mangaread âœ§getlink2 âœ§github âœ§convert
âœ§imgur âœ§memberlist âœ§namaj âœ§ownerx âœ§prefix âœ§qr âœ§rembg âœ§resetbalance âœ§bday
âœ§wish âœ§analytics âœ§apimarket âœ§appstore
âœ§compile âœ§emojimean âœ§getlink âœ§gcimg âœ§font âœ§ta(tag) âœ§snippet âœ§spam 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—™ğ—¨ğ—¡  ã€
âœ§clown âœ§drip âœ§duck âœ§elon âœ§emojimix âœ§hack âœ§inbox âœ§joke2 âœ§love âœ§mark âœ§married âœ§motivation âœ§myfact âœ§myquote âœ§nokia âœ§pickuplines âœ§propose âœ§quote âœ§rip âœ§rizz âœ§sad âœ§train âœ§wishcard âœ§gay âœ§berojgar âœ§fun2 âœ§mistake âœ§content âœ§hell âœ§joke âœ§fun âœ§smsg âœ§khaby âœ§willsmith 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—šğ—”ğ— ğ—˜  ã€
âœ§wordguess âœ§aniquiz âœ§daily âœ§dhbc âœ§dicedash âœ§fish âœ§flag âœ§frogjump âœ§guessactor âœ§guessnumber âœ§memorygame âœ§penalty âœ§riddle âœ§tod âœ§truthordare âœ§ttt âœ§tttv2 âœ§tttvx âœ§uncrossable âœ§worker âœ§xcup
âœ§pet âœ§country  âœ§fight âœ§quiz âœ§slot  
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—•ğ—¢ğ—«-ğ—–ğ—›ğ—”ğ—§ ã€
âœ§adduser âœ§admin âœ§all âœ§antichangeinfobox âœ§autosetname âœ§badwords âœ§ban âœ§busy âœ§count âœ§filteruser âœ§kick âœ§nncheck âœ§onlyadminbox âœ§refresh âœ§rules âœ§sendnoti âœ§setname âœ§unsend âœ§warn âœ§nn âœ§spamban
âœ§spamkick âœ§supportgc âœ§setleave âœ§system âœ§setwelcome âœ§shortcut âœ§support
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—–ğ—¢ğ—¡ğ—§ğ—¥ğ—”ğ—–ğ—§-ğ—”ğ——ğ— ğ—œğ—¡ğ—¦ ã€
âœ§callad
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—¨ğ—§ğ—œğ—Ÿğ—œğ—§ğ—¬  ã€
âœ§album âœ§botstats âœ§cmdstore âœ§connectgc âœ§image âœ§imgbb âœ§inf âœ§ipshow âœ§tempmail âœ§translate âœ§upscaleai âœ§v2a âœ§view âœ§home
âœ§pinjourney âœ§muptime âœ§antiout âœ§ip
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—™ğ—¨ğ—¡-ğŸ® ã€
 âœ§berojgar  âœ§dance 
 âœ§fun âœ§fun2 âœ§cm
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—¨ğ—§ğ—œğ—Ÿğ—œğ—§ğ—¬-ğŸ® ã€
âœ§accept âœ§avatar1 âœ§cricket âœ§gmage âœ§pastebin âœ§requestmain âœ§short âœ§weather
âœ§cbin âœ§info âœ§movieinfo âœ§stalk âœ§ss âœ§ss2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—œğ—¡ğ—™ğ—¢  ã€
 âœ§cbin âœ§info âœ§stalk âœ§cardinfo âœ§cardinfo2
âœ§cover2 âœ§fbcover
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—™ğ—¢ğ—¢ğ—§ğ—•ğ—”ğ—Ÿğ—Ÿ  ã€
 âœ§messi âœ§neymar âœ§ramos
 âœ§ronaldo
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ——ğ—˜ğ—©ğ—˜ğ—Ÿğ—¢ğ—£ğ—˜ğ—¥  ã€
 âœ§scrape âœ§whitelist 
 âœ§whitelistthread
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—˜ğ— ğ—˜  ã€
âœ§sciencememe âœ§smeme  âœ§buttslap âœ§cry 
âœ§gname âœ§trash âœ§programmingmeme âœ§cry âœ§trash âœ§wanted âœ§meme
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—§ğ—§ğ—¦  ã€
 âœ§say  âœ§anya2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—¦ğ—§ğ—¨ğ——ğ—¬  ã€
 âœ§quote2 âœ§fixgrammar âœ§advice âœ§fact  
â•°â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—šğ—¥ğ—¢ğ—¨ğ—£  ã€
 âœ§spamkick âœ§top âœ§topxp
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€  ğ—”ğ—¡ğ—œğ— ğ—˜ ã€
âœ§aniblur âœ§aniedit âœ§animetime âœ§anivid âœ§bleachinfo âœ§naruinfo âœ§opinfo âœ§twixtor
âœ§anipic âœ§anigif âœ§animeinfo âœ§animequotes âœ§animetrend âœ§anitrace âœ§anivoice âœ§bankai âœ§bleach âœ§dance âœ§manga âœ§mangadex âœ§waifux âœ§anistatus âœ§onepiece âœ§xenoz
âœ§aniwatch âœ§cdp2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—˜ğ—–ğ—¢ğ—¡ğ—¢ğ— ğ—¬  ã€
 âœ§balance âœ§money âœ§richest âœ§set âœ§bank
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—§ğ—˜ğ—«ğ—§ğ—£ğ—¥ğ—¢  ã€
 âœ§khaby âœ§willsmith âœ§quote3
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€ã€ ğ—–ğ—¢ğ—¡ğ—§ğ—¥ğ—”ğ—–ğ—§ ã€
 âœ§callad  âœ§botgc 
 âœ§supportgc
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—¨ğ—¦ğ—œğ—–  ã€
âœ§animesong âœ§media âœ§sing âœ§spotify âœ§youtubex âœ§lyrics
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—Ÿğ—¢ğ—šğ—¢  ã€
 âœ§cardinfo âœ§cardinfo2 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—˜ğ——ğ—œğ—” ã€
âœ§fyp âœ§tiktok âœ§video âœ§alldl âœ§autolink âœ§ytb âœ§collab âœ§overlay âœ§write âœ§youtube
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€ ğ—Ÿğ—¢ğ—©ğ—˜ ã€
âœ§kiss âœ§marry âœ§pair2 âœ§pair3 âœ§ship âœ§us
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€  ğ—¦ğ—¢ğ—–ğ—œğ—”ğ—Ÿ  ã€
 âœ§fbpost âœ§fbreport âœ§fbshare
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—”ğ—œ-ğ—–ğ—›ğ—”ğ—§ ã€
âœ§anya2 âœ§blackbox âœ§gemini âœ§gojo âœ§gpt âœ§roast âœ§gpt âœ§hinu âœ§baby
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—šğ—™ğ—« ã€
 âœ§gfx  âœ§gfx3 âœ§gfx4
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—”ğ—œ-ğ—šğ—˜ğ—¡ğ—˜ğ—¥ğ—”ğ—§ğ—˜ğ—— ã€
âœ§realis âœ§xl30 âœ§alya âœ§alya2 âœ§flux âœ§flux2   âœ§niji5 âœ§niji6 âœ§nijiv5 âœ§nijiv6 âœ§animex âœ§xl  âœ§xl4 âœ§wc(prompt) âœ§prompt âœ§emi âœ§gen
âœ§nigi âœ§nixi âœ§fluxv2 âœ§niji âœ§nijiz âœ§genx âœ§playgroundu âœ§imaginex âœ§fluxx âœ§xl31
âœ§dallex âœ§prompt3 âœ§imagejourney (ij) âœ§pr
âœ§imagine âœ§prompt2 âœ§poli âœ§art âœ§dalle
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—£ğ—¢ğ—ğ—˜ğ— ğ—¢ğ—¡ ã€
âœ§pokebot   âœ§pokeinfo  âœ§pokechamps âœ§pokedex  âœ§poketrade
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—–ğ—¨ğ—¦ğ—§ğ—¢ğ—  ã€
 âœ§setleave âœ§setwelcome 
 âœ§shortcut
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—ªğ—”ğ—œğ—™ğ—¨ ğ—šğ—”ğ— ğ—˜ ã€
âœ§waifuinfo âœ§waifudex
âœ§waifupull âœ§waifusell âœ§waifusellall
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—¥ğ—”ğ—¡ğ—  ã€
 âœ§customrankcard âœ§rank 
 âœ§ranktop âœ§rankup âœ§top âœ§topxp
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š


â”â”â” ğ—¦ğ—¨ğ—£ğ—£ğ—¢ğ—¥ğ—§ ğ—•ğ—¢ğ—« â”â”â”
Join Nisimiya Bot Zone âˆ Support Box type: !supportgc or type: !callad to contact with admins.

â‡’ Total: ${totalCommands} commands
â‡’ Use /help <cmd> to get more information about a command
        `;
        await message.reply(customHelpMessage);
    },

    listCommandsByCategory: async function (category, message) {
        const allCommands = Array.from(commands.entries()).sort();
        let formattedResponse = "";

        formattedResponse += `â•­â”€â”€ã€  ${category} ã€\n`;

        for (const [command, config] of allCommands) {
            if (command.charAt(0).toUpperCase() === category) {
                formattedResponse += `âœ§${command} `;
            }
        }

        if (formattedResponse === `â•­â”€â”€ã€  ${category} ã€\n`) {
            await message.reply(`No commands found for category ${category}.`);
            return;
        }

        formattedResponse += `\nâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š\n\nTotal ${category} category cmds = ${allCommands.filter(cmd => cmd[0].charAt(0).toUpperCase() === category).length}`;

        await message.reply(formattedResponse);
    },

    listAllCommands: async function (message) {
        const allCommands = Array.from(commands.keys()).sort();
        let formattedResponse = "";

        formattedResponse += `â•­â”€â”€ã€  ğ—•ğ—¢ğ—§ğ—¡ğ—”ğ— ğ—˜ ã€\n`;
        formattedResponse += `âœ§ ${boldText("NIÅHÄ°MÄ°YA")} \n`;
        formattedResponse += `â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š\n\n`;

        let currentLetter = '';
        for (const command of allCommands) {
            const firstLetter = command.charAt(0).toUpperCase();
            if (firstLetter !== currentLetter) {
                if (currentLetter !== '') {
                    formattedResponse += `â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š\n\n`;
                }
                currentLetter = firstLetter;
                formattedResponse += `â•­â”€â”€ã€  ${firstLetter} cmds ã€\n`;
            }
            formattedResponse += `âœ§${command} `;
        }

        formattedResponse += `\nâ•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š\n\n`;
        formattedResponse += `â”œâ”€â”€â”€â”€â”€â”€â”€â­”\n Â» Currently, the bot has (${commands.size}) commands that can be used\n`;

        await message.reply(formattedResponse);
    },

    getCommandInfo: async function (commandName) {
        const command = commands.get(commandName);
        
        if (command) {
            const { config } = command;
            const guideBody = config.guide?.en || config.guide?.["en"] || '';

            return {
                name: config.name,
                version: config.version,
                author: config.author || 'Unknown',
                aliases: (config.aliases || []).join(', ') || 'None',
                groupAliases: (config.groupAliases || []).join(', ') || 'None',
                role: config.role,
                roleText: getRoleText(config.role),
                countDown: config.countDown || 1,
                usage: guideBody.split('\n').map(line => `â€¢ ${line}`).join('\n') || 'No usage information available',
                description: config.longDescription?.en || 'No details available'
            };
        } else {
            return null;
        }
    }
};

function boldText(text) {
    return `ğ™‰ğ™„ğ™ğ™ƒğ™„ğ™ˆğ™„ğ™”ğ˜¼ ğ“ƒ`;
}

function getRoleText(role) {
    switch (role) {
        case 0: return '0 (All users)';
        case 1: return '1 (Group administrators)';
        case 2: return '2 (Admin bot)';
        default: return 'Do not have';
    }
}
