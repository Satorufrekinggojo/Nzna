const axios = require("axios");
const path = require("path");
const fs = require("fs-extra");
const { getPrefix } = global.utils;
const { commands, aliases } = global.GoatBot;
const doNotDelete = null;

module.exports = {
  config: {
    name: "help",
    version: "1.0",
    author: "NTKhang | Rehat86",
    countDown: 5,
    role: 0,
    category: "info",
    guide: {
      en: "{pn} [empty or <command name>] [-s <category>]"
    },
    priority: 1
  },

  langs: {
    en: {
      help: `â•”â•â•â•â•â•â•â•â•â•â•â•â•—
    ğ—¡ğ—¶ğ˜€ğ—µğ—¶ğ—ºğ—¶ğ˜†ğ—® ğ—–ğ—µğ—®ğ˜ğ—¯ğ—¼ğ˜
â•šâ•â•â•â•â•â•â•â•â•â•â•â•

â•­â”€â”€ã€  ğ—¢ğ—ªğ—¡ğ—˜ğ—¥  ã€
 âœ§adminonly âœ§approved 
 âœ§backupdata âœ§bin 
 âœ§bio âœ§bot âœ§spam
 âœ§cmd âœ§code âœ§deletecmd
 âœ§devonly  âœ§edit6
 âœ§edit8 âœ§editx âœ§event
 âœ§file âœ§getfbstate 
 âœ§hubble âœ§ignoreonlyad 
 âœ§ignoreonlyadbox 
 âœ§jsontomongodb 
 âœ§listbox âœ§loadconfig
 âœ§notice âœ§notification
 âœ§owner âœ§owner2 âœ§respect 
 âœ§setavt âœ§setlang 
 âœ§setrankup âœ§thread âœ§up 
 âœ§update âœ§upt âœ§upt2 âœ§upt3 
 âœ§user âœ§vip âœ§w
 âœ§w4 âœ§resetprefix âœ§setalias
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—”ğ——ğ— ğ—œğ—¡  ã€
 âœ§block âœ§leave âœ§main 
 âœ§automaticaccept
 âœ§usage âœ§out âœ§ping 
 âœ§addfile âœ§autoget 
 âœ§chekjson âœ§delete âœ§stats 
 âœ§adminlist âœ§testhtml
 âœ§uptime âœ§uptime2 
 âœ§autoseen âœ§clean âœ§eval 
 âœ§join âœ§shell 
 âœ§goatbotcommandcreate 
 âœ§example 
 âœ§goatmart âœ§restart
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—œğ— ğ—”ğ—šğ—˜  ã€
 âœ§affect âœ§arrest âœ§avatar
 âœ§banner âœ§batslap âœ§blink
 âœ§Chad âœ§coupledp âœ§cover 
 âœ§ephoto âœ§giphy âœ§horror
 âœ§imgsearch âœ§imgur âœ§link
 âœ§mpanel âœ§pin âœ§pr
 âœ§profile âœ§prompt 
 âœ§sorthelp âœ§spy
 âœ§template âœ§trigger
 âœ§ws âœ§cover2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—§ğ—¢ğ—¢ğ—Ÿ'ğ—¦  ã€
 âœ§fakechat âœ§memberlist 
 âœ§qrcode âœ§wish âœ§namaj 
 âœ§ocr âœ§owners âœ§clonevoice 
 âœ§ownerx âœ§prefix âœ§qr âœ§nn
 âœ§fbaccount âœ§system 
 âœ§rembg âœ§home âœ§support 
 âœ§muptime âœ§weather 
 âœ§emojimean âœ§post
 âœ§apimarket âœ§device
 âœ§theme âœ§tag âœ§font
 âœ§countryinfo âœ§botstats 
 âœ§deldatabase âœ§bday 
 âœ§fbcover âœ§ analytics
 âœ§testjs âœ§antiout âœ§ip 
 âœ§appstore âœ§devicetop
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—™ğ—¨ğ—¡  ã€
 âœ§ball âœ§biden âœ§cat
 âœ§card âœ§clown âœ§drip 
 âœ§duck âœ§elon âœ§emojimix 
 âœ§emojistory âœ§fact 
 âœ§flirt âœ§hack âœ§impress 
 âœ§inbox âœ§joke2 âœ§love 
 âœ§mark âœ§married âœ§myfact 
 âœ§myquote âœ§nokia 
 âœ§notify âœ§obama 
 âœ§propose âœ§quote âœ§quotes 
 âœ§randomcatname âœ§rip
 âœ§rizz âœ§sad âœ§spiderman 
 âœ§anya âœ§kiss2 âœ§meme 
 âœ§taylorquote âœ§tes 
 âœ§train âœ§wishcard 
 âœ§content âœ§hell âœ§joke 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—šğ—”ğ— ğ—˜  ã€
 âœ§aniquiz âœ§candycrush 
 âœ§dhbc âœ§dice âœ§tof
 âœ§dicedash âœ§frogjump 
 âœ§guessactorâœ§playcard 
 âœ§guessnumber 
 âœ§memorygame âœ§daily 
 âœ§penalty âœ§riddle 
 âœ§quiz âœ§fight 
 âœ§tictactoe âœ§tod âœ§ttt 
 âœ§coinflip âœ§tttv2
 âœ§tttvx âœ§uncrossable 
 âœ§wordguess âœ§worker
 âœ§xcup âœ§slot 
 âœ§truthordare âœ§country
 âœ§slot âœ§fish âœ§goingmarry
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—•ğ—¢ğ—«-ğ—–ğ—›ğ—”ğ—§ ã€
 âœ§adduser âœ§admin âœ§ads
 âœ§all âœ§antichangeinfobox 
 âœ§autosetname âœ§badwords 
 âœ§ban âœ§busy âœ§count 
 âœ§filteruser âœ§gay âœ§kick 
 âœ§membercountâœ§menu 
 âœ§nncheckâœ§onlyadminbox 
 âœ§refresh âœ§rules 
 âœ§sendnoti âœ§setname
 âœ§unsend âœ§warn 
 âœ§spamban âœ§spygc
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—¨ğ—§ğ—œğ—Ÿğ—œğ—§ğ—¬  ã€
 âœ§album âœ§amvquote
 âœ§bibleverse âœ§cmdstore 
 âœ§connectgc âœ§image âœ§imgbb 
 âœ§inf âœ§ipshow âœ§monitor 
 âœ§note âœ§sendwebhook 
 âœ§translate âœ§upscaleai 
 âœ§v2a âœ§view âœ§word âœ§smg 
 âœ§ss âœ§tempmail âœ§tg 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—™ğ—¨ğ—¡-ğŸ® ã€
 âœ§berojgar  âœ§dance 
 âœ§fun âœ§fun2 âœ§cm
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—¨ğ—§ğ—œğ—Ÿğ—œğ—§ğ—¬-ğŸ®  ã€
 âœ§accept âœ§avatar1 âœ§bc
 âœ§calendar âœ§cricket 
 âœ§gmage âœ§pastebin 
 âœ§requestmain âœ§short
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—œğ—¡ğ—™ğ—¢  ã€
 âœ§cbin âœ§info âœ§stalk
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—™ğ—¢ğ—¢ğ—§ğ—•ğ—”ğ—Ÿğ—Ÿ  ã€
 âœ§messi âœ§neymar âœ§ramos
 âœ§ronaldo
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ——ğ—˜ğ—©ğ—˜ğ—Ÿğ—¢ğ—£ğ—˜ğ—¥  ã€
 âœ§scrape âœ§whitelist 
 âœ§whitelistthread
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—˜ğ— ğ—˜  ã€
 âœ§sciencememe âœ§smeme 
 âœ§buttslap âœ§cry 
 âœ§gname âœ§trash 
 âœ§wanted
 âœ§programmingmeme 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—§ğ—§ğ—¦  ã€
 âœ§say  âœ§anya2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—¦ğ—§ğ—¨ğ——ğ—¬  ã€
 âœ§advice âœ§fact 
 âœ§motivation 
 âœ§motivation2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—šğ—¥ğ—¢ğ—¨ğ—£  ã€
 âœ§spamkick âœ§top âœ§topxp
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€  ğ—”ğ—¡ğ—œğ— ğ—˜ ã€
 âœ§anigif âœ§animeinfo 
 âœ§animequotes âœ§aniwatch
 âœ§animetrend âœ§anitrace
 âœ§anivoice âœ§one-piece
 âœ§bleach âœ§jjk âœ§manga
 âœ§anime âœ§xenoz âœ§mangadex
 âœ§mangaread âœ§quote2 
 âœ§waifux âœ§art âœ§animegirl 
 âœ§naruinfo âœ§opinfo 
 âœ§bleachinfo âœ§anistatus 
 âœ§aniblur âœ§aniedit 
 âœ§animetime âœ§twixtor 
 âœ§anipic
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—˜ğ—–ğ—¢ğ—¡ğ—¢ğ— ğ—¬  ã€
 âœ§balance âœ§money âœ§resetbal
 âœ§coin âœ§richest âœ§set
 âœ§bank âœ§currequest 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—§ğ—˜ğ—«ğ—§ğ—£ğ—¥ğ—¢  ã€
 âœ§khaby âœ§willsmith âœ§quote3
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€ã€ ğ—–ğ—¢ğ—¡ğ—§ğ—¥ğ—”ğ—–ğ—§ ã€
 âœ§callad  âœ§botgc 
 âœ§supportgc
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—¨ğ—¦ğ—œğ—–  ã€
 âœ§animesong âœ§audio 
 âœ§media âœ§sing âœ§spotify 
 âœ§voicify âœ§youtubex 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—Ÿğ—¢ğ—šğ—¢  ã€
 âœ§cardinfo âœ§cardinfo2 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ— ğ—˜ğ——ğ—œğ—” ã€
 âœ§autolink âœ§chords 
 âœ§convert âœ§getlink2
 âœ§github âœ§lv 
 âœ§lyrics âœ§singx âœ§anya2 
 âœ§collab âœ§tiktok âœ§pmvd 
 âœ§pubgedit âœ§overlay 
 âœ§youtube âœ§ytb âœ§alldl 
 âœ§getlink âœ§moviedl 
 âœ§song âœ§video
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€ ğ—Ÿğ—¢ğ—©ğ—˜ ã€
 âœ§cdp âœ§kiss âœ§pair2 
 âœ§pair3 âœ§ship âœ§us âœ§cdp2
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€â”€ã€  ğ—¦ğ—¢ğ—–ğ—œğ—”ğ—Ÿ  ã€
 âœ§fbpost âœ§fbreport âœ§fbshare
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—”ğ—œ ğ—–ğ—›ğ—”ğ—§ ã€
 âœ§ask âœ§clips âœ§gemini 
 âœ§geminiv2 âœ§gen 
 âœ§gojo âœ§gpt âœ§hina âœ§roast 
 âœ§snoop âœ§bby âœ§boxai âœ§ai
 âœ§hinu âœ§yamato âœ§smsg
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—šğ—™ğ—« ã€
 âœ§gfx  âœ§gfx2 âœ§gfx3 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—”ğ—œ-ğ—šğ—˜ğ—¡ğ—˜ğ—¥ğ—”ğ—§ğ—˜ğ—— ã€
 âœ§prompt3 âœ§imagejourney 
 âœ§dallex  âœ§imaginex 
 âœ§imagine âœ§genx âœ§sdxl 
 âœ§niji âœ§nijiz âœ§alya
 âœ§realis âœ§imagine
 âœ§fluxv2 âœ§emi âœ§gen 
 âœ§nixi âœ§xl31 âœ§ poli
 âœ§nigi âœ§xl30 âœ§flux âœ§mgen 
 âœ§reality âœ§xl âœ§nijiv5
 âœ§fluxv2 âœ§nijiv6 âœ§xl4
 âœ§alya2 âœ§xs âœ§niji5
 âœ§flux2 âœ§niji6 âœ§ xl2
 âœ§wc(prompt) 
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—£ğ—¢ğ—ğ—˜ğ— ğ—¢ğ—¡ ã€
 âœ§pokebot    âœ§pokeinfo 
 âœ§pokechamps âœ§pokedex 
 âœ§poketrade
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—–ğ—¨ğ—¦ğ—§ğ—¢ğ—  ã€
 âœ§setleave âœ§setwelcome 
 âœ§shortcut
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€ ğ—ªğ—”ğ—œğ—™ğ—¨ ğ—šğ—”ğ— ğ—˜ ã€
 âœ§waifulist âœ§waifutop
 âœ§waifuinfo âœ§waifuinv 
 âœ§waifupull âœ§waifudex 
 âœ§waifusellall
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â•­â”€â”€ã€  ğ—¥ğ—”ğ—¡ğ—  ã€
 âœ§customrankcard âœ§rank 
 âœ§ranktop âœ§rankup 
 âœ§ranking
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—Š

â”â”â” ğ—¦ğ—¨ğ—£ğ—£ğ—¢ğ—¥ğ—§ ğ—•ğ—¢ğ—« â”â”â”
join Nisimiya Bot Zone âˆ Support Box type: !supportgc or type: !callad to contact with admins.

â‡’ Total: 412 commands
â‡’ Use /help <cmd> to get more information about a command and /helpx a ( to see a specific cmd)`, // Keep the existing help text as it is
      commandNotFound: "Command \"%1\" does not exist",
      getInfoCommand: "Â» Description: %2\nÂ» Other names: %3\nÂ» Other names in your group: %4\nÂ» Version: %5\nÂ» Role: %6\nÂ» Time per command: %7s\nÂ» Author: %8\nâ”â”â”  â–  â”â”â”\nÂ» Usage guide:\n%9\nâ”â”â”  â–  â”â”â”\nÂ» Notes:\nâ€¢ The content inside <XXXXX> can be changed\nâ€¢ The content inside [a|b|c] is a or b or c",
      onlyInfo: "â”â”â”  â–  â”â”â”\nâ”‚ Command name: %1\nâ”‚ Description: %2\nâ”‚ Other names: %3\nâ”‚ Other names in your group: %4\nâ”‚ Version: %5\nâ”‚ Role: %6\nâ”‚ Time per command: %7s\nâ”‚ Author: %8\nâ–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–",
      onlyUsage: "â–â”€â”€ USAGE â”€â”€â”€â”€â–\nâ”‚%1\nâ–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–",
      onlyAlias: "â–â”€â”€ ALIAS â”€â”€â”€â”€â–\nâ”‚ Other names: %1\nâ”‚ Other names in your group: %2\nâ–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–",
      onlyRole: "â–â”€â”€ ROLE â”€â”€â”€â”€â–\nâ”‚%1\nâ–â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–",
      doNotHave: "Do not have",
      roleText0: "0 (All users)",
      roleText1: "1 (Group administrators)",
      roleText2: "2 (Admin bot)",
      roleText0setRole: "0 (set role, all users)",
      roleText1setRole: "1 (set role, group administrators)",
      pageNotFound: "Page %1 does not exist",
      totalCategoryCommands: "Total %1 commands in category %2:"
    }
  },

  onStart: async function ({ message, args, event, threadsData, getLang, role, api, usersData}) {

    const langCode = await threadsData.get(event.threadID, "data.lang") || global.GoatBot.config.language;
    let customLang = {};
    const pathCustomLang = path.join(__dirname, "..", "..", "languages", "cmds", `${langCode}.js`);
    if (fs.existsSync(pathCustomLang))
      customLang = require(pathCustomLang);
    const { threadID } = event;
    const threadData = await threadsData.get(threadID);
    const prefix = getPrefix(threadID);
    let sortHelp = threadData.settings.sortHelp || "name";
    if (!["category", "name"].includes(sortHelp))
      sortHelp = "name";
    const commandName = (args[0] || "").toLowerCase();
    const command = commands.get(commandName) || commands.get(aliases.get(commandName));

    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” LIST COMMANDS BY CATEGORY (SHORT OPTION) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    if (args[0] === "-s" && args[1]) {
      const category = args[1].toLowerCase();
      const arrayInfo = [];
      for (const [name, value] of commands) {
        if (value.config.category && value.config.category.toLowerCase().startsWith(category) && (value.config.role <= role || value.config.role == undefined)) {
          let describe = name;
          let shortDescription;
          const shortDescriptionCustomLang = customLang[name]?.shortDescription;
          if (shortDescriptionCustomLang != undefined)
            shortDescription = checkLangObject(shortDescriptionCustomLang, langCode);
          else if (value.config.shortDescription)
            shortDescription = checkLangObject(value.config.shortDescription, langCode);
          if (shortDescription)
            describe += `: ${cropContent(shortDescription.charAt(0).toUpperCase() + shortDescription.slice(1))}`;
          arrayInfo.push(describe);
        }
      }
      const total = arrayInfo.length;
      const msg = `${getLang("totalCategoryCommands", total, category)}\n\n${arrayInfo.join("\n")}`;
      return message.reply(msg);
    }

    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” LIST ALL COMMAND â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    if (!command && !args[0] || !isNaN(args[0])) {
      const arrayInfo = [];
      let msg = "";
      if (sortHelp == "name") {
        const page = parseInt(args[0]) || 1;
        const numberOfOnePage = 30;
        for (const [name, value] of commands) {
          if (value.config.role > 1 && role < value.config.role)
            continue;
          let describe = name;
          let shortDescription;
          const shortDescriptionCustomLang = customLang[name]?.shortDescription;
          if (shortDescriptionCustomLang != undefined)
            shortDescription = checkLangObject(shortDescriptionCustomLang, langCode);
          else if (value.config.shortDescription)
            shortDescription = checkLangObject(value.config.shortDescription, langCode);
          if (shortDescription)
            describe += `: ${cropContent(shortDescription.charAt(0).toUpperCase() + shortDescription.slice(1))}`;
          arrayInfo.push({
            data: describe,
            priority: value.priority || 0
          });
        }
        arrayInfo.sort((a, b) => a.data - b.data);
        arrayInfo.sort((a, b) => a.priority > b.priority ? -1 : 1);
        const { allPage, totalPage } = global.utils.splitPage(arrayInfo, numberOfOnePage);
        if (page < 1 || page > totalPage)
          return message.reply(getLang("pageNotFound", page));
        const returnArray = allPage[page - 1] || [];
        const startNumber = (page - 1) * numberOfOnePage + 1;
        msg += (returnArray || []).reduce((text, item, index) => text += `â”‚ ${index + startNumber}${index + startNumber < 10 ? " " : ""}. ${item.data}\n`, '').slice(0, -1);
        await message.reply(getLang("help", msg, page, totalPage, commands.size, prefix, doNotDelete));
      };
    }
    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” COMMAND DOES NOT EXIST â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    else if (!command && args[0]) {
      return message.reply(getLang("commandNotFound", args[0]));
    }
    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” INFO COMMAND â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    else {
      const formSendMessage = {};
      const configCommand = command.config;

      let guide = configCommand.guide?.[langCode] || configCommand.guide?.["en"];
      if (guide == undefined)
        guide = customLang[configCommand.name]?.guide?.[langCode] || customLang[configCommand.name]?.guide?.["en"];

      guide = guide || {
        body: ""
      };
      if (typeof guide == "string")
        guide = { body: guide };
      const guideBody = guide.body
        .replace(/\{prefix\}|\{p\}/g, prefix)
        .replace(/\{name\}|\{n\}/g, configCommand.name)
        .replace(/\{pn\}/g, prefix + configCommand.name);

      const aliasesString = configCommand.aliases ? configCommand.aliases.join(", ") : getLang("doNotHave");
      const aliasesThisGroup = threadData.data.aliases ? (threadData.data.aliases[configCommand.name] || []).join(", ") : getLang("doNotHave");

      let roleOfCommand = configCommand.role;
      let roleIsSet = false;
      if (threadData.data.setRole?.[configCommand.name]) {
        roleOfCommand = threadData.data.setRole[configCommand.name];
        roleIsSet = true;
      }

      const roleText = roleOfCommand == 0 ?
        (roleIsSet ? getLang("roleText0setRole") : getLang("roleText0")) :
        roleOfCommand == 1 ?
          (roleIsSet ? getLang("roleText1setRole") : getLang("roleText1")) :
          getLang("roleText2");

      const author = configCommand.author;
      const descriptionCustomLang = customLang[configCommand.name]?.longDescription;
      let description = checkLangObject(configCommand.longDescription, langCode);
      if (description == undefined)
        if (descriptionCustomLang != undefined)
          description = checkLangObject(descriptionCustomLang, langCode);
          else if (value.config.shortDescription)
            shortDescription = checkLangObject(value.config.shortDescription, langCode);
          if (shortDescription)
            describe += `: ${cropContent(shortDescription.charAt(0).toUpperCase() + shortDescription.slice(1))}`;
          arrayInfo.push({
            data: describe,
            priority: value.priority || 0
          });
        }
        arrayInfo.sort((a, b) => a.data - b.data);
        arrayInfo.sort((a, b) => a.priority > b.priority ? -1 : 1);
        const { allPage, totalPage } = global.utils.splitPage(arrayInfo, numberOfOnePage);
        if (page < 1 || page > totalPage)
          return message.reply(getLang("pageNotFound", page));
        const returnArray = allPage[page - 1] || [];
        const startNumber = (page - 1) * numberOfOnePage + 1;
        msg += (returnArray || []).reduce((text, item, index) => text += `â”‚ ${index + startNumber}${index + startNumber < 10 ? " " : ""}. ${item.data}\n`, '').slice(0, -1);
        await message.reply(getLang("help", msg, page, totalPage, commands.size, prefix, doNotDelete));
      };
    }
    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” COMMAND DOES NOT EXIST â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    else if (!command && args[0]) {
      return message.reply(getLang("commandNotFound", args[0]));
    }
    // â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” INFO COMMAND â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” //
    else {
      const formSendMessage = {};
      const configCommand = command.config;

      let guide = configCommand.guide?.[langCode] || configCommand.guide?.["en"];
      if (guide == undefined)
        guide = customLang[configCommand.name]?.guide?.[langCode] || customLang[configCommand.name]?.guide?.["en"];

      guide = guide || {
        body: ""
      };
      if (typeof guide == "string")
        guide = { body: guide };
      const guideBody = guide.body
        .replace(/\{prefix\}|\{p\}/g, prefix)
        .replace(/\{name\}|\{n\}/g, configCommand.name)
        .replace(/\{pn\}/g, prefix + configCommand.name);

      const aliasesString = configCommand.aliases ? configCommand.aliases.join(", ") : getLang("doNotHave");
      const aliasesThisGroup = threadData.data.aliases ? (threadData.data.aliases[configCommand.name] || []).join(", ") : getLang("doNotHave");

      let roleOfCommand = configCommand.role;
      let roleIsSet = false;
      if (threadData.data.setRole?.[configCommand.name]) {
        roleOfCommand = threadData.data.setRole[configCommand.name];
        roleIsSet = true;
      }

      const roleText = roleOfCommand == 0 ?
        (roleIsSet ? getLang("roleText0setRole") : getLang("roleText0")) :
        roleOfCommand == 1 ?
          (roleIsSet ? getLang("roleText1setRole") : getLang("roleText1")) :
          getLang("roleText2");

      const author = configCommand.author;
      const descriptionCustomLang = customLang[configCommand.name]?.longDescription;
      let description = checkLangObject(configCommand.longDescription, langCode);
      if (description == undefined)
        if (descriptionCustomLang != undefined)
          description = checkLangObject(descriptionCustomLang, langCode);
        else
          description = getLang("doNotHave");

      let sendWithAttachment = false;

      if (args[1]?.match(/^-g|guide|-u|usage$/)) {
        formSendMessage.body = getLang("onlyUsage", guideBody.split("\n").join("\n"));
        sendWithAttachment = true;
      }
      else if (args[1]?.match(/^-a|alias|aliase|aliases$/))
        formSendMessage.body = getLang("onlyAlias", aliasesString, aliasesThisGroup);
      else if (args[1]?.match(/^-r|role$/))
        formSendMessage.body = getLang("onlyRole", roleText);
      else if (args[1]?.match(/^-i|info$/))
        formSendMessage.body = getLang("onlyInfo", configCommand.name, description, aliasesString, aliasesThisGroup, configCommand.version, roleText, configCommand.countDown || 1, author || "");
      else {
        formSendMessage.body = getLang("getInfoCommand", configCommand.name, description, aliasesString, aliasesThisGroup, configCommand.version, roleText, configCommand.countDown || 1, author || "", `${guideBody.split("\n").join("\n")}`);
        sendWithAttachment = true;
      }

      if (sendWithAttachment && guide.attachment) {
        if (typeof guide.attachment == "object") {
          formSendMessage.attachment = [];
          for (const pathFile in guide.attachment) {
            if (!fs.existsSync(pathFile)) {
              const cutFullPath = pathFile.split("/").filter(item => item != "");
              cutFullPath.pop();
              for (let i = 0; i < cutFullPath.length; i++) {
                const path = cutFullPath.slice(0, i + 1).join('/');
                if (!fs.existsSync(path))
                  fs.mkdirSync(path);
              }
              const getFile = await axios.get(guide.attachment[pathFile], { responseType: 'arraybuffer' });
              fs.writeFileSync(pathFile, Buffer.from(getFile.data));
            }
            formSendMessage.attachment.push(fs.createReadStream(pathFile));
          }
        }
      }
      return message.reply(formSendMessage);
    }
  }
};

function checkLangObject(data, langCode) {
  if (typeof data == "string")
    return data;
  if (typeof data == "object" && !Array.isArray(data))
    return data[langCode] || data.en || undefined;
  return undefined;
}

function cropContent(content, max) {
  if (content.length > max) {
    content = content.slice(0, max - 3);
    content = content + "...";
  }
  return content;
}
